import{a as Je,b as Ye}from"./chunk-2MCK5UHE.js";import{a as He,b as $e}from"./chunk-I2DXY6UB.js";import{a as je,b as Ve,c as Oe}from"./chunk-NGMVSYUE.js";import{a as E}from"./chunk-B6XUQAAW.js";import{a as Be,b as Ge}from"./chunk-LY4QMYNA.js";import"./chunk-EFHJHWTA.js";import{a as ze}from"./chunk-SR7PA7IC.js";import{a as We}from"./chunk-FXVTEMQC.js";import{a as le,b as pe,h as Ne,i as De,l as Fe,m as $,n as Ue,q as U,r as ke,u as Re,y as C}from"./chunk-MMPXYFCE.js";import{$a as ye,A as a,B as l,Ba as ge,Bb as d,C as Q,Ca as he,Cb as Le,D as X,Db as W,E as A,Ea as Me,Eb as Y,F as M,Fa as _e,Fb as u,G as _,Ga as Ie,Ha as Pe,M as s,Ma as V,N as F,O as h,Qa as Ce,Sa as O,Ta as B,V as ie,Va as J,W as oe,Wa as xe,X as y,Xa as ve,Y as w,Za as Se,ab as we,ba as j,ea as I,fa as ne,ga as re,i as p,ia as ae,ka as se,l as v,la as T,lb as Ae,m as S,nb as be,oa as P,ob as H,p as te,pa as me,q as r,qb as G,r as c,ra as ce,rb as Ee,s as k,sa as L,t as m,ta as de,tb as Te,ua as ue,v as R,wa as fe,y as g,z as n,zb as z}from"./chunk-EBSCITWR.js";import"./chunk-SXPKCTI2.js";import"./chunk-QUJFQN2Y.js";import"./chunk-OXEFE5QV.js";import"./chunk-YBM4N2KB.js";import"./chunk-LP7GEQAZ.js";import"./chunk-6J55XCPC.js";import"./chunk-ZIUATYQZ.js";import"./chunk-R2JHLMPZ.js";import"./chunk-3OJLU4RE.js";import"./chunk-TVD3BM6U.js";import"./chunk-DJ7TON2V.js";import"./chunk-BMJVVMK5.js";import"./chunk-33XXLDGD.js";import"./chunk-7X6IXJPA.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-B2QWJ5X3.js";import"./chunk-CKP3SGE2.js";import"./chunk-SKR7DL2M.js";import{g as f}from"./chunk-2R6CW7ES.js";var Ke=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=m({type:e});static \u0275inj=p({imports:[I,P,d,u,C]})}return e})();var qe=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=m({type:e});static \u0275inj=p({imports:[I,P,d,u,C]})}return e})();var Qe=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=m({type:e});static \u0275inj=p({imports:[I,P,d,u,C]})}return e})();var K=class{http;prefix;suffix;constructor(x,t="/assets/i18n/",i=".json"){this.http=x,this.prefix=t,this.suffix=i}getTranslation(x){return this.http.get(`${this.prefix}${x}${this.suffix}`)}};function ft(e,x){if(e&1){let t=A();n(0,"div"),s(1," You are not signed in. "),n(2,"button",5),M("click",function(){v(t);let o=_();return S(o.showSignInModal())}),s(3),y(4,"translate"),a()()}e&2&&(r(3),F(w(4,1,"ocm.general.signIn")))}function gt(e,x){if(e&1&&(n(0,"div")(1,"ion-card")(2,"ion-item")(3,"ion-avatar",6),l(4,"img",7),a(),n(5,"h2"),s(6),a()(),n(7,"ion-card-content")(8,"p"),s(9),a(),n(10,"p"),s(11),a()(),n(12,"ion-item")(13,"ion-note",8),l(14,"ion-icon",9),s(15),a()()()()),e&2){let t=_();r(4),g("src",ie(t.userProfile.ProfileImageURL),te),r(2),F(t.userProfile.Username),r(3),h(" ",t.userProfile.Profile),r(2),h(" Date Joined: ",t.userProfile.DateCreated," "),r(4),h(" ",t.userProfile.ReputationPoints," Contributor Points ")}}var q=(()=>{class e{appManager;nav;translate;modalController;userProfile;constructor(t,i,o,D){this.appManager=t,this.nav=i,this.translate=o,this.modalController=D}ionViewDidEnter(){this.userProfile=this.appManager.getUserProfile(),this.userProfile==null||!this.appManager.isUserAuthenticated(!0)?this.showSignInModal():this.refreshProfileView(),this.appManager.analytics.viewEvent("Profile")}refreshProfileView(){this.userProfile=this.appManager.getUserProfile()}showSignInModal(){this.modalController.create({component:U,componentProps:{Profile:this.userProfile}}).then(t=>{t.onDidDismiss().then(()=>{this.refreshProfileView()}),t.present()})}close(){this.modalController.dismiss()}static \u0275fac=function(i){return new(i||e)(c($),c(ue),c(W),c(z))};static \u0275cmp=k({type:e,selectors:[["ng-component"]],standalone:!1,decls:14,vars:5,consts:[[1,"profile-page","ion-padding"],[4,"ngIf"],["slot","end"],[3,"click"],["name","close","slot","start"],["ion-button","",3,"click"],["slot","start"],[3,"src"],["item-left",""],["name","star"]],template:function(i,o){i&1&&(n(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),s(3),y(4,"translate"),a()()(),n(5,"ion-content",0),R(6,ft,5,3,"div",1)(7,gt,16,6,"div",1),a(),n(8,"ion-footer")(9,"ion-toolbar")(10,"ion-buttons",2)(11,"ion-button",3),M("click",function(){return o.close()}),l(12,"ion-icon",4),s(13," Close "),a()()()()),i&2&&(r(3),h(" ",w(4,3,"ocm.navigation.profile.sectionTitle")," "),r(3),g("ngIf",o.userProfile==null),r(),g("ngIf",o.userProfile!=null))},dependencies:[j,he,Me,_e,Ie,Pe,V,Ce,O,B,J,we,H,G,Y],encapsulation:2})}return e})();var N=E("PushNotifications",{});var Xe=E("StatusBar");var Ze=E("SplashScreen",{web:()=>import("./chunk-CPGS2HHO.js").then(e=>new e.SplashScreenWeb)});var Z=E("App",{web:()=>import("./chunk-QZ3QEPMC.js").then(e=>new e.AppWeb)});var ht=()=>["/search"];function Mt(e,x){if(e&1){let t=A();n(0,"ion-item",9),M("click",function(){v(t);let o=_();return S(o.openRoutePlannerModal())}),l(1,"ion-icon",12),n(2,"ion-label"),s(3," Route Planner "),a()()}}function _t(e,x){if(e&1){let t=A();n(0,"ion-item",9),M("click",function(){v(t);let o=_();return S(o.add())}),l(1,"ion-icon",13),n(2,"ion-label"),s(3),y(4,"translate"),a()()}e&2&&(r(3),h(" ",w(4,1,"ocm.general.addLocation")," "))}function It(e,x){if(e&1){let t=A();n(0,"ion-item",9),M("click",function(){v(t);let o=_();return S(o.journeys())}),l(1,"ion-icon",12),n(2,"ion-label"),s(3," Journeys "),a()()}}function Pt(e,x){if(e&1){let t=A();n(0,"ion-item",9),M("click",function(){v(t);let o=_();return S(o.addLayer())}),l(1,"ion-icon",14),n(2,"ion-label"),s(3," Add Layer "),a()()}}function Ct(e,x){if(e&1){let t=A();Q(0),n(1,"ion-item",9),M("click",function(){v(t);let o=_();return S(o.signIn())}),l(2,"ion-icon",15),n(3,"ion-label"),s(4),y(5,"translate"),a()(),X()}e&2&&(r(4),h(" ",w(5,1,"ocm.general.signIn")," "))}function xt(e,x){if(e&1){let t=A();Q(0),n(1,"ion-item",9),M("click",function(){v(t);let o=_();return S(o.profile())}),l(2,"ion-icon",15),n(3,"ion-label"),s(4),y(5,"translate"),a()(),n(6,"ion-item",9),M("click",function(){v(t);let o=_();return S(o.signOut())}),l(7,"ion-icon",16),n(8,"ion-label"),s(9),y(10,"translate"),l(11,"br"),n(12,"small",17),s(13),a()()(),X()}if(e&2){let t=_();r(4),h(" ",w(5,3,"ocm.navigation.profile.sectionTitle")," "),r(5),h(" ",w(10,5,"ocm.general.signOut")," "),r(4),h(" ",t.getUserName())}}var et=(()=>{class e{platform;translate;mapping;modalController;appManager;logger;analytics;events;enabledFeatures;constructor(t,i,o,D,ee,at,st,lt){this.platform=t,this.translate=i,this.mapping=o,this.modalController=D,this.appManager=ee,this.logger=at,this.analytics=st,this.events=lt,this.logger.log("Environment: "+T.name),this.initializeApp(),this.enabledFeatures=T.enabledFeatures,ee.searchSettings.EnableAdvancedEditorFeatures!=!0&&(this.enabledFeatures=this.enabledFeatures.filter(pt=>pt!="LAYERS"))}configurePushNotifications(){N.register(),N.addListener("registration",t=>{this.logger.log("Push registration success, token: "+t.value),this.appManager.savePushRegistration(t.value)}),N.addListener("registrationError",t=>{this.logger.log("Error on registration: "+JSON.stringify(t))}),N.addListener("pushNotificationReceived",t=>{this.logger.log("Push received: "+JSON.stringify(t),le.INFO)}),N.addListener("pushNotificationActionPerformed",t=>{this.logger.log("Push action performed: "+JSON.stringify(t))})}isUserAuthenticated(){return this.appManager.isUserAuthenticated()}getUserName(){let t=this.appManager.getUserProfile();return t?t.EmailAddress?t.EmailAddress:t.Username:"Not Signed In"}initializeApp(){this.platform.ready().then(()=>{this.platform.is("capacitor")&&(Xe.show(),Ze.hide()),this.translate.addLangs(this.appManager.getLanguages().map(t=>t.code)),this.translate.setDefaultLang("en"),this.appManager.searchSettings.Language!=null?this.translate.use(this.appManager.searchSettings.Language):this.translate.currentLang||this.translate.use("en"),this.translate.get("ocm.search.performSearch").toPromise().then(t=>{}),this.analytics.init(T.analyticsId).then(()=>{this.analytics.setAppVersion(T.version),this.analytics.appEvent("Startup","App Loaded")}).catch(t=>this.logger.log("Error starting analytics")),this.events.subscribe("ocm:mapping:addpoi",t=>f(this,null,function*(){Ue.isFeatureEnabled("ADD_POI")&&this.add(t)})),(this.platform.is("ios")||this.platform.is("android"))&&(this.configurePushNotifications(),this.checkForAppOpenUrl())})}checkForAppOpenUrl(){return f(this,null,function*(){Z.addListener("appUrlOpen",i=>{alert("App (re)opened with URL: "+i.url)});let t=yield Z.getLaunchUrl();t&&t.url&&alert("App opened with URL: "+t.url)})}openRoutePlannerModal(){return f(this,null,function*(){this.mapping.unfocusMap();let t=yield this.modalController.create({component:Ve});t.onDidDismiss().then(i=>{this.mapping.focusMap()}),yield t.present()})}continueAdd(t){return f(this,null,function*(){let i=yield this.modalController.create({component:Re,componentProps:{startPos:t}});i.onDidDismiss().then(o=>{this.mapping.focusMap()}),yield i.present()})}add(t){return f(this,null,function*(){if(this.mapping.unfocusMap(),this.appManager.isUserAuthenticated(!0))yield this.continueAdd(t);else{let i=yield this.modalController.create({component:U});return i.onDidDismiss().then(o=>f(this,null,function*(){this.mapping.focusMap(),this.appManager.isUserAuthenticated(!0)&&(yield this.continueAdd(t))})),yield i.present()}})}signIn(){return f(this,null,function*(){this.mapping.unfocusMap();let t=yield this.modalController.create({component:U});return t.onDidDismiss().then(i=>{this.mapping.focusMap(),this.appManager.isUserAuthenticated(!0)}),yield t.present()})}signOut(){return f(this,null,function*(){this.appManager.signOutCurrentUser()})}profile(){return f(this,null,function*(){this.mapping.unfocusMap();let t=yield this.modalController.create({component:q});t.onDidDismiss().then(i=>{this.mapping.focusMap()}),yield t.present()})}journeys(){return f(this,null,function*(){this.mapping.unfocusMap();let t=yield this.modalController.create({component:Be});t.onDidDismiss().then(i=>{this.mapping.focusMap()}),yield t.present()})}addLayer(){return f(this,null,function*(){let t=yield this.modalController.create({component:He});yield t.present();let{data:i}=yield t.onWillDismiss();i&&this.mapping.addPOILayer(i)})}about(){return f(this,null,function*(){this.mapping.unfocusMap();let t=yield this.modalController.create({component:Je});t.onDidDismiss().then(i=>{this.mapping.focusMap()}),yield t.present()})}static \u0275fac=function(i){return new(i||e)(c(de),c(W),c(ke),c(z),c($),c(pe),c(De),c(Ne))};static \u0275cmp=k({type:e,selectors:[["app-root"]],standalone:!1,decls:29,vars:17,consts:[["contentId","main-content",3,"disabled"],["contentId","main-content","swipeGesture","false"],["slot","start"],["src","assets/images/icons/branding/AppIcon_128x128.png"],["auto-hide","false"],[3,"routerDirection","routerLink"],["slot","start","name","home"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],["slot","start","name","information-circle-outline"],["id","main-content"],["slot","start","name","map"],["slot","start","name","add-circle-outline"],["slot","start","name","albums"],["slot","start","name","person"],["slot","start","name","log-out"],[2,"color","#c0c0c0"]],template:function(i,o){i&1&&(n(0,"ion-app")(1,"ion-split-pane",0)(2,"ion-menu",1)(3,"ion-header")(4,"ion-toolbar")(5,"ion-thumbnail",2),l(6,"img",3),a(),n(7,"ion-title"),s(8),a()()(),n(9,"ion-content")(10,"ion-list")(11,"ion-menu-toggle",4)(12,"ion-item",5),l(13,"ion-icon",6),n(14,"ion-label"),s(15),y(16,"translate"),a()(),R(17,Mt,4,0,"ion-item",7)(18,_t,5,3,"ion-item",7)(19,It,4,0,"ion-item",7)(20,Pt,4,0,"ion-item",7)(21,Ct,6,3,"ng-container",8)(22,xt,14,7,"ng-container",8),n(23,"ion-item",9),M("click",function(){return o.about()}),l(24,"ion-icon",10),n(25,"ion-label"),s(26),y(27,"translate"),a()()()()()(),l(28,"ion-router-outlet",11),a()()),i&2&&(r(),g("disabled",!0),r(7),F(o.appManager.title),r(4),g("routerDirection","root")("routerLink",oe(16,ht)),r(3),h(" ",w(16,12,"ocm.search.sectionTitle")," "),r(2),g("ngIf",o.enabledFeatures.includes("ROUTE_PLANNER")),r(),g("ngIf",o.enabledFeatures.includes("ADD_POI")),r(),g("ngIf",o.enabledFeatures.includes("FAVOURITES")),r(),g("ngIf",o.enabledFeatures.includes("LAYERS")),r(),g("ngIf",!o.isUserAuthenticated()),r(),g("ngIf",o.isUserAuthenticated()),r(4),h(" ",w(27,14,"ocm.general.about")," "))},dependencies:[j,ge,V,O,B,J,xe,ve,Se,ye,Ae,be,H,G,Ee,Te,ce,Y],encapsulation:2})}return e})();var vt=[{path:"",redirectTo:"search",pathMatch:"full"},{path:"search",loadChildren:()=>import("./chunk-3TK5AZ2X.js").then(e=>e.SearchPageModule)},{path:"journeys",loadChildren:()=>import("./chunk-BQLG2PPY.js").then(e=>e.JourneysModule)},{path:"signin",loadChildren:()=>import("./chunk-IMWWC54E.js").then(e=>e.SignInModule)},{path:"poi-editor/:id",loadChildren:()=>import("./chunk-NGG3M556.js").then(e=>e.PoiEditorPageModule)},{path:"about",loadChildren:()=>import("./chunk-PIKFJRZ4.js").then(e=>e.AboutPageModule)},{path:"layer-editor",loadChildren:()=>import("./chunk-5TNVQRCW.js").then(e=>e.LayerEditorPageModule)}],tt=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=m({type:e});static \u0275inj=p({imports:[L.forRoot(vt,{useHash:!0}),L]})}return e})();var it=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=m({type:e});static \u0275inj=p({imports:[I,P,d,u,C]})}return e})();var ot=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=m({type:e});static \u0275inj=p({imports:[I,P,d,u,C,L.forChild([{path:"",component:q}])]})}return e})();var nt=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=m({type:e});static \u0275inj=p({imports:[I,P,d,u,C,L.forChild([{path:"",component:je}])]})}return e})();function St(){return localStorage.getItem("access_token")}function yt(e){return new K(e,"/assets/i18n/",".json")}var rt=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=m({type:e,bootstrap:[et]});static \u0275inj=p({providers:[{provide:me,useClass:fe}],imports:[re,se,u.forRoot({loader:{provide:Le,useFactory:yt,deps:[ae]}}),d.forRoot(),tt,Fe.forRoot({config:{tokenGetter:St}}),Oe,it,Ge,ze,Qe,Ke,qe,We,ot,nt,Ye,$e]})}return e})();T.production&&void 0;ne().bootstrapModule(rt).catch(e=>console.log(e));
