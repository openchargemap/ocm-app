import{a as Z2,b as W2}from"./chunk-NT465ERF.js";import{a as N2,b as Y2}from"./chunk-5LQ64KVM.js";import{a as T2,b as H2,c as U2}from"./chunk-LZTJX352.js";import{a as q}from"./chunk-5AN7VX2Z.js";import{a as G2,b as j2}from"./chunk-JN2HMFY5.js";import"./chunk-RIAA6NQL.js";import{a as R2}from"./chunk-U55RPIM2.js";import{a as O2}from"./chunk-EDOTF2US.js";import{a as c2,b as s2,h as B2,i as P2,l as _2,m as Y,n as I2,q as I,r as V2,u as S2,y as x}from"./chunk-QOS6BV6U.js";import{$a as D2,A as a,B as c,Bb as R,C as K,D as Q,Da as h2,Db as C,E as M,Ea as u2,Eb as z2,F as b,Fb as O,G as f,Ga as b2,Gb as W,Ha as f2,Hb as g,Ia as v2,Ja as w2,M as n,N as _,O as u,Oa as H,Sa as x2,Ua as U,V as r2,Va as G,W as l2,X as E,Xa as Z,Y as k,Ya as F2,Za as A2,ba as T,bb as E2,cb as k2,ea as v,fa as o2,ga as i2,i as s,ia as a2,ka as n2,l as A,m as D,na as L,nb as M2,p as e2,pb as y2,q as i,qa as w,qb as N,r as m,ra as p2,s as V,sb as j,t as p,ta as m2,tb as q2,ua as z,v as S,va as C2,vb as L2,wa as g2,y as h,ya as d2,z as o}from"./chunk-Q4PDWSI3.js";import"./chunk-GYI37D4C.js";import"./chunk-QUJFQN2Y.js";import"./chunk-UNN7QUJT.js";import"./chunk-JZ6YPS3M.js";import"./chunk-UHSJLR2U.js";import"./chunk-PTM2QU7L.js";import"./chunk-Z7QLWI7J.js";import"./chunk-DNXVUVY2.js";import"./chunk-ILNMGZQV.js";import"./chunk-CU3T7BCW.js";import"./chunk-BYDIVWPE.js";import"./chunk-HUY3J7ZV.js";import"./chunk-C3FK7VJ4.js";import"./chunk-LY46NRBX.js";import"./chunk-V6RSK3HS.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-VXSX7VBV.js";import"./chunk-CKP3SGE2.js";import"./chunk-4QO5GQIH.js";import{h as d}from"./chunk-B4AJQJMI.js";var J2=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=p({type:t});static \u0275inj=s({imports:[v,w,C,g,x]})}return t})();var $2=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=p({type:t});static \u0275inj=s({imports:[v,w,C,g,x]})}return t})();var K2=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=p({type:t});static \u0275inj=s({imports:[v,w,C,g,x]})}return t})();var J=class{http;prefix;suffix;constructor(F,e="/assets/i18n/",r=".json"){this.http=F,this.prefix=e,this.suffix=r}getTranslation(F){return this.http.get(`${this.prefix}${F}${this.suffix}`)}};function d1(t,F){if(t&1){let e=M();o(0,"div"),n(1," You are not signed in. "),o(2,"button",5),b("click",function(){A(e);let l=f();return D(l.showSignInModal())}),n(3),E(4,"translate"),a()()}t&2&&(i(3),_(k(4,1,"ocm.general.signIn")))}function h1(t,F){if(t&1&&(o(0,"div")(1,"ion-card")(2,"ion-item")(3,"ion-avatar",6),c(4,"img",7),a(),o(5,"h2"),n(6),a()(),o(7,"ion-card-content")(8,"p"),n(9),a(),o(10,"p"),n(11),a()(),o(12,"ion-item")(13,"ion-note",8),c(14,"ion-icon",9),n(15),a()()()()),t&2){let e=f();i(4),h("src",r2(e.userProfile.ProfileImageURL),e2),i(2),_(e.userProfile.Username),i(3),u(" ",e.userProfile.Profile),i(2),u(" Date Joined: ",e.userProfile.DateCreated," "),i(4),u(" ",e.userProfile.ReputationPoints," Contributor Points ")}}var $=(()=>{class t{appManager;nav;translate;modalController;userProfile;constructor(e,r,l,P){this.appManager=e,this.nav=r,this.translate=l,this.modalController=P}ionViewDidEnter(){this.userProfile=this.appManager.getUserProfile(),this.userProfile==null||!this.appManager.isUserAuthenticated(!0)?this.showSignInModal():this.refreshProfileView(),this.appManager.analytics.viewEvent("Profile")}refreshProfileView(){this.userProfile=this.appManager.getUserProfile()}showSignInModal(){this.modalController.create({component:I,componentProps:{Profile:this.userProfile}}).then(e=>{e.onDidDismiss().then(()=>{this.refreshProfileView()}),e.present()})}close(){this.modalController.dismiss()}static \u0275fac=function(r){return new(r||t)(m(Y),m(g2),m(O),m(R))};static \u0275cmp=V({type:t,selectors:[["ng-component"]],standalone:!1,decls:14,vars:5,consts:[[1,"profile-page","ion-padding"],[4,"ngIf"],["slot","end"],[3,"click"],["name","close","slot","start"],["ion-button","",3,"click"],["slot","start"],[3,"src"],["item-left",""],["name","star"]],template:function(r,l){r&1&&(o(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),n(3),E(4,"translate"),a()()(),o(5,"ion-content",0),S(6,d1,5,3,"div",1)(7,h1,16,6,"div",1),a(),o(8,"ion-footer")(9,"ion-toolbar")(10,"ion-buttons",2)(11,"ion-button",3),b("click",function(){return l.close()}),c(12,"ion-icon",4),n(13," Close "),a()()()()),r&2&&(i(3),u(" ",k(4,3,"ocm.navigation.profile.sectionTitle")," "),i(3),h("ngIf",l.userProfile==null),i(),h("ngIf",l.userProfile!=null))},dependencies:[T,u2,b2,f2,v2,w2,H,x2,U,G,Z,k2,N,j,W],encapsulation:2})}return t})();var B=q("PushNotifications",{});var Q2=q("StatusBar");var X2=q("SplashScreen",{web:()=>import("./chunk-XHSH27N4.js").then(t=>new t.SplashScreenWeb)});var X=q("App",{web:()=>import("./chunk-WLUCNW4B.js").then(t=>new t.AppWeb)});var u1=()=>["/search"];function b1(t,F){if(t&1){let e=M();o(0,"ion-item",9),b("click",function(){A(e);let l=f();return D(l.openRoutePlannerModal())}),c(1,"ion-icon",12),o(2,"ion-label"),n(3," Route Planner "),a()()}}function f1(t,F){if(t&1){let e=M();o(0,"ion-item",9),b("click",function(){A(e);let l=f();return D(l.add())}),c(1,"ion-icon",13),o(2,"ion-label"),n(3),E(4,"translate"),a()()}t&2&&(i(3),u(" ",k(4,1,"ocm.general.addLocation")," "))}function v1(t,F){if(t&1){let e=M();o(0,"ion-item",9),b("click",function(){A(e);let l=f();return D(l.journeys())}),c(1,"ion-icon",12),o(2,"ion-label"),n(3," Journeys "),a()()}}function w1(t,F){if(t&1){let e=M();o(0,"ion-item",9),b("click",function(){A(e);let l=f();return D(l.addLayer())}),c(1,"ion-icon",14),o(2,"ion-label"),n(3," Add Layer "),a()()}}function x1(t,F){if(t&1){let e=M();K(0),o(1,"ion-item",9),b("click",function(){A(e);let l=f();return D(l.signIn())}),c(2,"ion-icon",15),o(3,"ion-label"),n(4),E(5,"translate"),a()(),Q()}t&2&&(i(4),u(" ",k(5,1,"ocm.general.signIn")," "))}function F1(t,F){if(t&1){let e=M();K(0),o(1,"ion-item",9),b("click",function(){A(e);let l=f();return D(l.profile())}),c(2,"ion-icon",15),o(3,"ion-label"),n(4),E(5,"translate"),a()(),o(6,"ion-item",9),b("click",function(){A(e);let l=f();return D(l.signOut())}),c(7,"ion-icon",16),o(8,"ion-label"),n(9),E(10,"translate"),c(11,"br"),o(12,"small",17),n(13),a()()(),Q()}if(t&2){let e=f();i(4),u(" ",k(5,3,"ocm.navigation.profile.sectionTitle")," "),i(5),u(" ",k(10,5,"ocm.general.signOut")," "),i(4),u(" ",e.getUserName())}}var t1=(()=>{class t{platform;translate;mapping;modalController;appManager;logger;analytics;events;enabledFeatures;constructor(e,r,l,P,t2,a1,n1,c1){this.platform=e,this.translate=r,this.mapping=l,this.modalController=P,this.appManager=t2,this.logger=a1,this.analytics=n1,this.events=c1,this.logger.log("Environment: "+L.name),this.initializeApp(),this.enabledFeatures=L.enabledFeatures,t2.searchSettings.EnableAdvancedEditorFeatures!=!0&&(this.enabledFeatures=this.enabledFeatures.filter(s1=>s1!="LAYERS"))}configurePushNotifications(){B.register(),B.addListener("registration",e=>{this.logger.log("Push registration success, token: "+e.value),this.appManager.savePushRegistration(e.value)}),B.addListener("registrationError",e=>{this.logger.log("Error on registration: "+JSON.stringify(e))}),B.addListener("pushNotificationReceived",e=>{this.logger.log("Push received: "+JSON.stringify(e),c2.INFO)}),B.addListener("pushNotificationActionPerformed",e=>{this.logger.log("Push action performed: "+JSON.stringify(e))})}isUserAuthenticated(){return this.appManager.isUserAuthenticated()}getUserName(){let e=this.appManager.getUserProfile();return e?e.EmailAddress?e.EmailAddress:e.Username:"Not Signed In"}initializeApp(){this.platform.ready().then(()=>{this.platform.is("capacitor")&&(Q2.show(),X2.hide()),this.translate.addLangs(this.appManager.getLanguages().map(e=>e.code)),this.translate.setDefaultLang("en"),this.appManager.searchSettings.Language!=null?this.translate.use(this.appManager.searchSettings.Language):this.translate.currentLang||this.translate.use("en"),this.translate.get("ocm.search.performSearch").toPromise().then(e=>{}),this.analytics.init(L.analyticsId).then(()=>{this.analytics.setAppVersion(L.version),this.analytics.appEvent("Startup","App Loaded")}).catch(e=>this.logger.log("Error starting analytics")),this.events.subscribe("ocm:mapping:addpoi",e=>d(this,null,function*(){I2.isFeatureEnabled("ADD_POI")&&this.add(e)})),(this.platform.is("ios")||this.platform.is("android"))&&(this.configurePushNotifications(),this.checkForAppOpenUrl())})}checkForAppOpenUrl(){return d(this,null,function*(){X.addListener("appUrlOpen",r=>{alert("App (re)opened with URL: "+r.url)});let e=yield X.getLaunchUrl();e&&e.url&&alert("App opened with URL: "+e.url)})}openRoutePlannerModal(){return d(this,null,function*(){this.mapping.unfocusMap();let e=yield this.modalController.create({component:H2});e.onDidDismiss().then(r=>{this.mapping.focusMap()}),yield e.present()})}continueAdd(e){return d(this,null,function*(){let r=yield this.modalController.create({component:S2,componentProps:{startPos:e}});r.onDidDismiss().then(l=>{this.mapping.focusMap()}),yield r.present()})}add(e){return d(this,null,function*(){if(this.mapping.unfocusMap(),this.appManager.isUserAuthenticated(!0))yield this.continueAdd(e);else{let r=yield this.modalController.create({component:I});return r.onDidDismiss().then(l=>d(this,null,function*(){this.mapping.focusMap(),this.appManager.isUserAuthenticated(!0)&&(yield this.continueAdd(e))})),yield r.present()}})}signIn(){return d(this,null,function*(){this.mapping.unfocusMap();let e=yield this.modalController.create({component:I});return e.onDidDismiss().then(r=>{this.mapping.focusMap(),this.appManager.isUserAuthenticated(!0)}),yield e.present()})}signOut(){return d(this,null,function*(){this.appManager.signOutCurrentUser()})}profile(){return d(this,null,function*(){this.mapping.unfocusMap();let e=yield this.modalController.create({component:$});e.onDidDismiss().then(r=>{this.mapping.focusMap()}),yield e.present()})}journeys(){return d(this,null,function*(){this.mapping.unfocusMap();let e=yield this.modalController.create({component:G2});e.onDidDismiss().then(r=>{this.mapping.focusMap()}),yield e.present()})}addLayer(){return d(this,null,function*(){let e=yield this.modalController.create({component:N2});yield e.present();let{data:r}=yield e.onWillDismiss();r&&this.mapping.addPOILayer(r)})}about(){return d(this,null,function*(){this.mapping.unfocusMap();let e=yield this.modalController.create({component:Z2});e.onDidDismiss().then(r=>{this.mapping.focusMap()}),yield e.present()})}static \u0275fac=function(r){return new(r||t)(m(C2),m(O),m(V2),m(R),m(Y),m(s2),m(P2),m(B2))};static \u0275cmp=V({type:t,selectors:[["app-root"]],standalone:!1,decls:29,vars:17,consts:[["contentId","main-content",3,"disabled"],["contentId","main-content","swipeGesture","false"],["slot","start"],["src","assets/images/icons/branding/AppIcon_128x128.png"],["auto-hide","false"],[3,"routerDirection","routerLink"],["slot","start","name","home"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],["slot","start","name","information-circle-outline"],["id","main-content"],["slot","start","name","map"],["slot","start","name","add-circle-outline"],["slot","start","name","albums"],["slot","start","name","person"],["slot","start","name","log-out"],[2,"color","#c0c0c0"]],template:function(r,l){r&1&&(o(0,"ion-app")(1,"ion-split-pane",0)(2,"ion-menu",1)(3,"ion-header")(4,"ion-toolbar")(5,"ion-thumbnail",2),c(6,"img",3),a(),o(7,"ion-title"),n(8),a()()(),o(9,"ion-content")(10,"ion-list")(11,"ion-menu-toggle",4)(12,"ion-item",5),c(13,"ion-icon",6),o(14,"ion-label"),n(15),E(16,"translate"),a()(),S(17,b1,4,0,"ion-item",7)(18,f1,5,3,"ion-item",7)(19,v1,4,0,"ion-item",7)(20,w1,4,0,"ion-item",7)(21,x1,6,3,"ng-container",8)(22,F1,14,7,"ng-container",8),o(23,"ion-item",9),b("click",function(){return l.about()}),c(24,"ion-icon",10),o(25,"ion-label"),n(26),E(27,"translate"),a()()()()()(),c(28,"ion-router-outlet",11),a()()),r&2&&(i(),h("disabled",!0),i(7),_(l.appManager.title),i(4),h("routerDirection","root")("routerLink",l2(16,u1)),i(3),u(" ",k(16,12,"ocm.search.sectionTitle")," "),i(2),h("ngIf",l.enabledFeatures.includes("ROUTE_PLANNER")),i(),h("ngIf",l.enabledFeatures.includes("ADD_POI")),i(),h("ngIf",l.enabledFeatures.includes("FAVOURITES")),i(),h("ngIf",l.enabledFeatures.includes("LAYERS")),i(),h("ngIf",!l.isUserAuthenticated()),i(),h("ngIf",l.isUserAuthenticated()),i(4),u(" ",k(27,14,"ocm.general.about")," "))},dependencies:[T,h2,H,U,G,Z,F2,A2,D2,E2,M2,y2,N,j,q2,L2,m2,W],encapsulation:2})}return t})();var A1=[{path:"",redirectTo:"search",pathMatch:"full"},{path:"search",loadChildren:()=>import("./chunk-Z4FLV3A6.js").then(t=>t.SearchPageModule)},{path:"journeys",loadChildren:()=>import("./chunk-KUTFY4T2.js").then(t=>t.JourneysModule)},{path:"signin",loadChildren:()=>import("./chunk-RRIKYALK.js").then(t=>t.SignInModule)},{path:"poi-editor/:id",loadChildren:()=>import("./chunk-23NKJM3A.js").then(t=>t.PoiEditorPageModule)},{path:"about",loadChildren:()=>import("./chunk-YHQURXUW.js").then(t=>t.AboutPageModule)},{path:"layer-editor",loadChildren:()=>import("./chunk-UYCM7VUP.js").then(t=>t.LayerEditorPageModule)}],e1=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=p({type:t});static \u0275inj=s({imports:[z.forRoot(A1,{useHash:!0}),z]})}return t})();var r1=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=p({type:t});static \u0275inj=s({imports:[v,w,C,g,x]})}return t})();var l1=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=p({type:t});static \u0275inj=s({imports:[v,w,C,g,x,z.forChild([{path:"",component:$}])]})}return t})();var o1=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=p({type:t});static \u0275inj=s({imports:[v,w,C,g,x,z.forChild([{path:"",component:T2}])]})}return t})();function D1(){return localStorage.getItem("access_token")}function E1(t){return new J(t,"/assets/i18n/",".json")}var i1=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=p({type:t,bootstrap:[t1]});static \u0275inj=s({providers:[{provide:p2,useClass:d2}],imports:[i2,n2,g.forRoot({loader:{provide:z2,useFactory:E1,deps:[a2]}}),C.forRoot(),e1,_2.forRoot({config:{tokenGetter:D1}}),U2,r1,j2,R2,K2,J2,$2,O2,l1,o1,W2,Y2]})}return t})();L.production&&void 0;o2().bootstrapModule(i1).catch(t=>console.log(t));
